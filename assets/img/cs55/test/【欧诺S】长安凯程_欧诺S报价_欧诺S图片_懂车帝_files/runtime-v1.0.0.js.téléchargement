/*!
* @byted/secsdk-strategy v1.0.18
* (c) 2025
*/
!function(t){"function"==typeof define&&define.amd?define(t):t()}((function(){"use strict";function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function _createForOfIteratorHelper(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,i=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){i=!0,c=t},f:function(){try{a||null==r.return||r.return()}finally{if(i)throw c}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,e):void 0}}var _document$currentScri,_document$currentScri2,_document$currentScri3,version="1.0.1",sampleRatio="0",whiteProjectIds=["518","515","80","519","517","454","501","522"],blackProjectIds=["lgw"],projectId=null===(_document$currentScri=document.currentScript)||void 0===_document$currentScri?void 0:_document$currentScri.getAttribute("project-id"),src=null===(_document$currentScri2=document.currentScript)||void 0===_document$currentScri2?void 0:_document$currentScri2.getAttribute("src"),_URL=new URL(src,window.location.href),host=_URL.host,isLocal=null===(_document$currentScri3=document.currentScript)||void 0===_document$currentScri3?void 0:_document$currentScri3.getAttribute("src").includes("./dist"),latestUrl=isLocal?"./dist/runtime-v1.0.1.umd.js":host.includes("sf")?"https://sf-security.ibytedtos.com/obj/secsdk-sg/runtime-stable.js":"https://lf-security.bytegoofy.com/obj/security-secsdk/runtime-stable.js",grayUrl=isLocal?"./dist/runtime-v1.0.1.umd.js":host.includes("sf")?"https://sf-security.ibytedtos.com/obj/secsdk-gray-sg/runtime-stable.js":"https://lf-security.bytegoofy.com/obj/security-secsdk-gray/runtime-v".concat(version,".js"),matchResult=function(t,e){var r,n=t.path,o=t.value,c=t.op,a=window,i=n.split("."),u=0,s=_createForOfIteratorHelper(i);try{for(s.s();!(r=s.n()).done;){var d=r.value;a&&(u++,a=a[d])}}catch(t){s.e(t)}finally{s.f()}if(!(0===t.tagerProjectIds.length||t.tagerProjectIds.includes(e)))return!1;if(window!==a&&u===i.length){if("==="===c)return a===o;if("!=="===c)return a!==o}return!1};if(projectId){var _document$currentScri4,isGray=function(){if(projectId&&whiteProjectIds.includes(projectId))return!1;if(projectId&&blackProjectIds.includes(projectId))return!0;for(var t=[],e=0,r=[[{path:"gfdatav1.env",value:"prod",op:"===",tagerProjectIds:[]},{path:"gfdatav1.envName",value:"canary",op:"!==",tagerProjectIds:[]},{path:"gfdatav1.envName",value:"prod",op:"!==",tagerProjectIds:[]}],{path:"gfdatav1.env",value:"boe",op:"===",tagerProjectIds:[]}];e<r.length;e++){var n=r[e];Array.isArray(n)?t.push(n.every((function(t){return matchResult(t,projectId)}))):t.push(matchResult(n,projectId))}return Math.floor(1e4*Math.random())<Number(sampleRatio)&&t.push(!0),0!==t.length&&t.some((function(t){return t}))},currentUrl="".concat(isGray()?grayUrl:latestUrl);localStorage.setItem("web_runtime_switcher_isgray",String(isGray()));var nonce=(null===(_document$currentScri4=document.currentScript)||void 0===_document$currentScri4?void 0:_document$currentScri4.nonce)||"",cacheKey="web_runtime_switcher_".concat(isGray()?version:"latest"),nativeFetch=window.fetch,report=function(t,e){var r=window.navigator,n=r.sendBeacon,o=n&&"function"==typeof n,c=document.currentScript.getAttribute("custom-report-host");if(!host.includes("sf")&&!c){var a="https://mon.zijieapi.com/monitor_browser/collect/batch/security/?bid=global",i={event_name:t,event_pageUrl:window.location.href,event_payload:"{}",fromStage:"init",documentURL:window.location.href,is_gray:String(isGray()),sdkVersion:version};e&&(i.errorStack_name=e.name,i.errorStack_message=e.message,i.errorStack_detail=e.detail);var u={age:Date.now(),url:projectId,type:"runtime_strategy",report:{reportString:i,reportInt:{event_timestamp:Date.now()}},"user-agent":window.navigator.userAgent};if(o)n.call(r,a,JSON.stringify(u))||nativeFetch(a,{method:"post",mode:"cors",body:JSON.stringify(u),headers:{"Content-Type":"application/json"}});else nativeFetch(a,{method:"post",mode:"cors",body:JSON.stringify(u),headers:{"Content-Type":"application/json"}})}};fetch(currentUrl).then((function(t){return t.text()})).then((function(t){var e,r=null===(e=window.SDKNativeWebApi)||void 0===e?void 0:e.API_LOCALSTORAGE_SET;r?r.fn.apply(localStorage,[cacheKey,t]):localStorage.setItem(cacheKey,t)}));try{localStorage.getItem(cacheKey)?eval(localStorage.getItem(cacheKey)):document.writeln('<script src="'.concat(currentUrl,'" nonce="').concat(nonce,'" project-id="').concat(projectId,'"><\/script>')),Math.floor(1e3*Math.random())<1&&report("SWITCHER_LOAD_SUCCESS")}catch(t){report("SWITCHER_LOAD_ERROR",t)}}}));
